{"version":3,"sources":["../source/FileUpload.js"],"names":["PureComponent","Component","FileUpload","state","draggedOver","onFileSelect","event","props","onChange","multiple","ieTimer","action","Error","value","Array","prototype","slice","call","target","files","setTimeout","undefined","onClick","disabled","preventDefault","fileInput","click","onKeyDown","ctrlKey","altKey","shiftKey","metaKey","keyCode","setDraggedOver","setState","storeFileInputNode","node","required","error","tabIndex","style","className","children","HIDDEN","propTypes","func","bool","string","number","isRequired","object","defaultProps","display"],"mappings":"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","file":"FileUpload.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\n\r\nimport { DropFiles, supportsMultipleFileUploadOnInputElement } from './DragAndDrop'\r\n\r\nimport { submitFormOnCtrlEnter } from './utility/dom'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nexport default class FileUpload extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// On file(s) chosen.\r\n\t\tonChange  : PropTypes.func,\r\n\r\n\t\t// (deprecated, use `onChange` instead).\r\n\t\t// On file(s) chosen.\r\n\t\taction    : PropTypes.func,\r\n\r\n\t\t// Allows choosing multiple files if `true`.\r\n\t\tmultiple  : PropTypes.bool,\r\n\r\n\t\t// Disables the file input.\r\n\t\tdisabled  : PropTypes.bool,\r\n\r\n\t\t// `onClick` handler.\r\n\t\tonClick   : PropTypes.func,\r\n\r\n\t\t// Whether choosing a file is required.\r\n\t\trequired : PropTypes.bool,\r\n\r\n\t\t// Renders an error message below the `<input/>`.\r\n\t\terror     : PropTypes.string,\r\n\r\n\t\ttabIndex  : PropTypes.number.isRequired,\r\n\r\n\t\t// The clickable area, like \"Click here to choose a file\".\r\n\t\tchildren  : PropTypes.node,\r\n\r\n\t\t// CSS class\r\n\t\tclassName : PropTypes.string,\r\n\r\n\t\t// CSS style object\r\n\t\tstyle     : PropTypes.object\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\ttabIndex : 0\r\n\t}\r\n\r\n\tstate =\r\n\t{\r\n\t\tdraggedOver : false\r\n\t}\r\n\r\n\tonFileSelect = (event) =>\r\n\t{\r\n\t\tlet { onChange, multiple } = this.props\r\n\r\n\t\t// Internet Explorer triggers `onChange` when setting\r\n\t\t// `event.target.value` manually, so ignore such events.\r\n\t\tif (this.ieTimer) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// `action` property is deprecated.\r\n\t\tonChange = onChange || this.props.action\r\n\r\n\t\t// This check will be replaced with `onChange : PropTypes.func.isRequired`\r\n\t\t// when `action` property is removed in some next breaking release.\r\n\t\tif (!onChange) {\r\n\t\t\tthrow new Error(`\"onChange\" handler not passed.`)\r\n\t\t}\r\n\r\n\t\t// Convert from `FileList` to an `Array`.\r\n\t\tconst value = Array.prototype.slice.call(event.target.files)\r\n\t\t// `<input multiple/>` attribute is not supported in all browsers.\r\n\t\tonChange(multiple ? value : value[0])\r\n\r\n\t\t// Internet Explorer triggers `onChange` when setting\r\n\t\t// `event.target.value` manually, hence the cooldown timer.\r\n\t\tthis.ieTimer = setTimeout(() => this.ieTimer = undefined, 0)\r\n\t\t// Reset the selected file\r\n\t\t// so that `onChange` is triggered again next time\r\n\t\t// even if the user selects the same file.\r\n\t\tevent.target.value = null\r\n\t}\r\n\r\n\tonClick = (event) =>\r\n\t{\r\n\t\tconst { disabled, onClick } = this.props\r\n\r\n\t\tif (disabled && event) {\r\n\t\t\treturn event.preventDefault()\r\n\t\t}\r\n\r\n\t\tif (onClick) {\r\n\t\t\tonClick()\r\n\t\t}\r\n\r\n\t\t// This is why `onClick` is set on the `<input/>`.\r\n\t\tthis.fileInput.click()\r\n\t}\r\n\r\n\tonKeyDown = (event) => {\r\n\t\tif (event.ctrlKey || event.altKey || event.shiftKey || event.metaKey) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tswitch (event.keyCode) {\r\n\t\t\t// \"Enter\".\r\n\t\t\tcase 13:\r\n\t\t\t// Spacebar.\r\n\t\t\tcase 32:\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t\t// Emulate `:active` on key press.\r\n\t\t\t\t// setTimeout(() => {\r\n\t\t\t\t// \tif (this._isMounted) {\r\n\t\t\t\t// \t\tthis.setState({\r\n\t\t\t\t// \t\t\tisActive: true\r\n\t\t\t\t// \t\t})\r\n\t\t\t\t// \t}\r\n\t\t\t\t// })\r\n\t\t\t\treturn this.onClick()\r\n\t\t}\r\n\t}\r\n\r\n\tsetDraggedOver = (draggedOver) => this.setState({ draggedOver })\r\n\r\n\tstoreFileInputNode = (node) => this.fileInput = node\r\n\r\n\trender()\r\n\t{\r\n\t\tconst\r\n\t\t{\r\n\t\t\trequired,\r\n\t\t\terror,\r\n\t\t\tdisabled,\r\n\t\t\ttabIndex,\r\n\t\t\tonChange,\r\n\t\t\tmultiple,\r\n\t\t\tstyle,\r\n\t\t\tclassName,\r\n\t\t\tchildren\r\n\t\t}\r\n\t\t= this.props\r\n\r\n\t\tconst { draggedOver } = this.state\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tstyle={ style }\r\n\t\t\t\tclassName={ classNames('rrui__file-upload', className) }>\r\n\r\n\t\t\t\t{/* Hidden. */}\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\tmultiple={ supportsMultipleFileUploadOnInputElement ? multiple : undefined }\r\n\t\t\t\t\tref={ this.storeFileInputNode }\r\n\t\t\t\t\tonClick={ this.onClick }\r\n\t\t\t\t\tonChange={ this.onFileSelect }\r\n\t\t\t\t\tdisabled={ disabled }\r\n\t\t\t\t\taria-label={ this.props['aria-label'] }\r\n\t\t\t\t\taria-required={ required ? true : undefined }\r\n\t\t\t\t\taria-invalid={ error ? true : undefined }\r\n\t\t\t\t\tstyle={ HIDDEN }/>\r\n\r\n\t\t\t\t<DropFiles\r\n\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\ttabIndex={ tabIndex }\r\n\t\t\t\t\taria-label={ this.props['aria-label'] }\r\n\t\t\t\t\tmultiple={ multiple }\r\n\t\t\t\t\tonDrop={ onChange }\r\n\t\t\t\t\tonClick={ this.onClick }\r\n\t\t\t\t\tonKeyDown={ this.onKeyDown }\r\n\t\t\t\t\tsetDraggedOver={ this.setDraggedOver }\r\n\t\t\t\t\tclassName={ classNames(\r\n\t\t\t\t\t\t/* Developers should define `:focus` styles for `<FileUpload/>`s. */\r\n\t\t\t\t\t\t'rrui__outline',\r\n\t\t\t\t\t\t'rrui__file-upload__area',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'rrui__file-upload__area--disabled' : disabled,\r\n\t\t\t\t\t\t\t'rrui__file-upload__area--invalid' : error,\r\n\t\t\t\t\t\t\t'rrui__file-upload__area--dragged-over' : draggedOver\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t) }>\r\n\t\t\t\t\t{ children }\r\n\t\t\t\t</DropFiles>\r\n\r\n\t\t\t\t{/* Error message (e.g. \"Required\"). */}\r\n\t\t\t\t{ error &&\r\n\t\t\t\t\t<div className=\"rrui__input-error\">\r\n\t\t\t\t\t\t{ error }\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst HIDDEN =\r\n{\r\n\tdisplay: 'none'\r\n}"]}