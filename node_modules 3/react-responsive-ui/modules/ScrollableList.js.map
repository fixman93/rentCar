{"version":3,"sources":["../source/ScrollableList.js"],"names":["PureComponent","Component","ScrollableList","state","verticalPadding","focusItem","index","list","focus","clearFocus","onListItemsChanged","onKeyDown","event","chooseFocusedItem","getFocusedItemIndex","onFocusItem","options","props","undefined","showItem","getListNode","storeListRef","ref","edge","children","itemElement","itemRefs","isFirstItem","isLastItem","Children","count","showTopLine","showBottomLine","topLine","offsetTop","scrollTop","bottomLine","offsetHeight","value","expandable","collapse","then","setValue","height","scrollHeight","parseInt","window","getComputedStyle","paddingTop","isOverflown","maxHeight","calculateScrollableListHeight","setState","scrollMaxItems","calculateHeight","scrollBarPadding","className","rest","listStyle","propTypes","number","isRequired","bool","string","defaultProps"],"mappings":"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","file":"ScrollableList.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\n\r\nimport List from './List'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nexport default class ScrollableList extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// // A list of items.\r\n\t\t// items : PropTypes.arrayOf\r\n\t\t// (\r\n\t\t// \tPropTypes.shape\r\n\t\t// \t({\r\n\t\t// \t\t// Item value (may be `undefined`).\r\n\t\t// \t\tvalue : PropTypes.any,\r\n\t\t// \t\t// Item label (may be `undefined`).\r\n\t\t// \t\tlabel : PropTypes.string,\r\n\t\t// \t\t// Item icon component.\r\n\t\t// \t\ticon  : PropTypes.func,\r\n\t\t// \t\t// Render custom content (a React component).\r\n\t\t// \t\t// Receives `{ value, label }` properties.\r\n\t\t// \t\tcontent : PropTypes.func\r\n\t\t// \t})\r\n\t\t// ),\r\n\r\n\t\t// Maximum items fitting the list height (scrollable).\r\n\t\t// Set to `0` to disable overflow.\r\n\t\t// Is `6` by default.\r\n\t\tscrollMaxItems : PropTypes.number.isRequired,\r\n\r\n\t\t// Whether should add `margin-right` for scrollbar width on overflow.\r\n\t\t// Is `true` by default.\r\n\t\tscrollBarPadding : PropTypes.bool,\r\n\r\n\t\tclassName : PropTypes.string\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\tscrollMaxItems : 6,\r\n\t\tscrollBarPadding : true\r\n\t}\r\n\r\n\tstate =\r\n\t{\r\n\t\t// Is initialized during the first `componentDidUpdate()` call.\r\n\t\tverticalPadding : 0\r\n\t}\r\n\r\n\t// Proxy `<List/>` methods.\r\n\tfocusItem = (index) => this.list.focusItem(index)\r\n\tfocus = () => this.list.focus()\r\n\tclearFocus = () => this.list.clearFocus()\r\n\tonListItemsChanged = () => this.list.onListItemsChanged()\r\n\tonKeyDown = (event) => this.list.onKeyDown(event)\r\n\tchooseFocusedItem = () => this.list.chooseFocusedItem()\r\n\tgetFocusedItemIndex = () => this.list.getFocusedItemIndex()\r\n\tfocusItem = (index) => this.list.focusItem(index)\r\n\r\n\tonFocusItem = (index, options) => {\r\n\t\tconst { onFocusItem } = this.props\r\n\t\tif (onFocusItem) {\r\n\t\t\tonFocusItem(index, options)\r\n\t\t}\r\n\t\t// When `<List/>` calls `.focusItem()` in `componentDidMount()`\r\n\t\t// `this.list` doesn't exist yet, hence the check.\r\n\t\tif (index !== undefined && this.list) {\r\n\t\t\tthis.showItem(index)\r\n\t\t}\r\n\t}\r\n\r\n\tgetListNode = () => this.list.list\r\n\r\n\t// Fully shows an option having the `value` (scrolls to it if neccessary)\r\n\tshowItem(index, edge = 'top')\r\n\t{\r\n\t\tconst { children } = this.props\r\n\r\n\t\tconst itemElement = this.list.itemRefs[index]\r\n\r\n\t\tconst isFirstItem = index === 0\r\n\t\tconst isLastItem  = index === React.Children.count(children) - 1\r\n\r\n\t\tif (isFirstItem) {\r\n\t\t\treturn this.showTopLine(itemElement, true)\r\n\t\t} else if (isLastItem) {\r\n\t\t\treturn this.showBottomLine(itemElement, true)\r\n\t\t}\r\n\r\n\t\tswitch (edge)\r\n\t\t{\r\n\t\t\tcase 'top':\r\n\t\t\t\treturn this.showTopLine(itemElement)\r\n\t\t\tcase 'bottom':\r\n\t\t\t\treturn this.showBottomLine(itemElement)\r\n\t\t}\r\n\t}\r\n\r\n\tshowTopLine(itemElement, isFirstItem)\r\n\t{\r\n\t\tconst { verticalPadding } = this.state\r\n\r\n\t\tlet topLine = itemElement.offsetTop\r\n\r\n\t\tif (isFirstItem) {\r\n\t\t\ttopLine -= verticalPadding\r\n\t\t}\r\n\r\n\t\tif (topLine < this.getListNode().scrollTop) {\r\n\t\t\tthis.getListNode().scrollTop = topLine\r\n\t\t}\r\n\t}\r\n\r\n\tshowBottomLine(itemElement, isLastItem)\r\n\t{\r\n\t\tconst { verticalPadding } = this.state\r\n\r\n\t\tlet bottomLine = itemElement.offsetTop + itemElement.offsetHeight\r\n\r\n\t\tif (isLastItem) {\r\n\t\t\tbottomLine += verticalPadding\r\n\t\t}\r\n\r\n\t\tif (bottomLine > this.getListNode().scrollTop + this.getListNode().offsetHeight) {\r\n\t\t\tthis.getListNode().scrollTop = bottomLine - this.getListNode().offsetHeight\r\n\t\t}\r\n\t}\r\n\r\n\tstoreListRef = (ref) => this.list = ref\r\n\r\n\titemOnClick(value, event)\r\n\t{\r\n\t\t// Collapse the `<Select/>`.\r\n\t\t// Doing `setValue` in a callback\r\n\t\t// because otherwise `setValue()` would result in\r\n\t\t// updating props and calling `getDerivedStateFromProps()`\r\n\t\t// which reads `autocomplete_value` which is being reset inside `.toggle()`.\r\n\t\tthis.expandable.collapse().then(() => this.setValue(value))\r\n\t}\r\n\r\n\t// Calculates height of the item list.\r\n\tcalculateHeight()\r\n\t{\r\n\t\tconst { children } = this.props\r\n\r\n\t\tconst height = this.getListNode().scrollHeight\r\n\t\tconst verticalPadding = parseInt(window.getComputedStyle(this.getListNode()).paddingTop)\r\n\r\n\t\tconst state = { height, verticalPadding }\r\n\r\n\t\t// Calculate the appropriate list height.\r\n\t\tif (this.isOverflown()) {\r\n\t\t\tstate.maxHeight = this.calculateScrollableListHeight(height, verticalPadding)\r\n\t\t}\r\n\r\n\t\tthis.setState(state)\r\n\t}\r\n\r\n\tcalculateScrollableListHeight(height, verticalPadding)\r\n\t{\r\n\t\tconst { scrollMaxItems, children } = this.props\r\n\r\n\t\t// Adding vertical padding here so that it shows `scrollMaxItems` items fully.\r\n\t\t// Also gives a peek on the `scrollMaxItems + 1`th item by showing a half of it.\r\n\t\treturn (height - 2 * verticalPadding) * ((scrollMaxItems + 0.5) / React.Children.count(children)) + verticalPadding\r\n\t}\r\n\r\n\tisOverflown()\r\n\t{\r\n\t\tconst { scrollMaxItems, children } = this.props\r\n\t\treturn scrollMaxItems > 0 && React.Children.count(children) > scrollMaxItems\r\n\t}\r\n\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tthis.calculateHeight()\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tconst\r\n\t\t{\r\n\t\t\tscrollBarPadding,\r\n\t\t\tclassName,\r\n\t\t\tchildren,\r\n\t\t\t...rest\r\n\t\t}\r\n\t\t= this.props\r\n\r\n\t\tconst { maxHeight } = this.state\r\n\r\n\t\tlet listStyle\r\n\r\n\t\t// Makes the list scrollable if it's max height is constrained.\r\n\t\tif (maxHeight !== undefined)\r\n\t\t{\r\n\t\t\tlistStyle = { maxHeight: `${maxHeight}px` }\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<List\r\n\t\t\t\t{...rest}\r\n\t\t\t\tref={ this.storeListRef }\r\n\t\t\t\tonFocusItem={ this.onFocusItem }\r\n\t\t\t\tstyle={ listStyle }\r\n\t\t\t\tclassName={ classNames(className,\r\n\t\t\t\t{\r\n\t\t\t\t\t'rrui__scrollable' : this.isOverflown()\r\n\t\t\t\t}) }>\r\n\t\t\t\t{ children }\r\n\t\t\t</List>\r\n\t\t)\r\n\t}\r\n}"]}