{"version":3,"sources":["../source/OnTapOutside.js"],"names":["OnTapOutside","onTouchStart","event","touches","length","onTouchCancel","initialTouchX","changedTouches","clientX","initialTouchY","clientY","tapping","onTouchMove","moveThreshold","props","deltaX","Math","abs","deltaY","onTouchEnd","onTap","undefined","getContainerNode","getTogglerNode","onTapOutside","contains","target","focusOut","document","addEventListener","removeEventListener","stopListeningToTouches","children","Component","propTypes","func","isRequired","number","defaultProps"],"mappings":"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","file":"OnTapOutside.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nexport default class OnTapOutside extends React.Component\r\n{\r\n\tstatic propTypes = {\r\n\t\tonTapOutside: PropTypes.func.isRequired,\r\n\t\tgetTogglerNode: PropTypes.func,\r\n\t\tgetContainerNode: PropTypes.func.isRequired,\r\n\t\tmoveThreshold: PropTypes.number.isRequired\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\tmoveThreshold: 5\r\n\t}\r\n\r\n\tlistenToTouches()\r\n\t{\r\n\t\tdocument.addEventListener('touchstart', this.onTouchStart)\r\n\t\tdocument.addEventListener('touchmove', this.onTouchMove)\r\n\t\tdocument.addEventListener('touchend', this.onTouchEnd)\r\n\t\tdocument.addEventListener('touchcancel', this.onTouchCancel)\r\n\t}\r\n\r\n\tstopListeningToTouches()\r\n\t{\r\n\t\tdocument.removeEventListener('touchstart', this.onTouchStart)\r\n\t\tdocument.removeEventListener('touchmove', this.onTouchMove)\r\n\t\tdocument.removeEventListener('touchend', this.onTouchEnd)\r\n\t\tdocument.removeEventListener('touchcancel', this.onTouchCancel)\r\n\t}\r\n\r\n\tcomponentWillUnmount()\r\n\t{\r\n\t\tthis.stopListeningToTouches()\r\n\t}\r\n\r\n\tonTouchStart = (event) =>\r\n\t{\r\n\t\t// Ignore multitouch.\r\n\t\tif (event.touches.length > 1)\r\n\t\t{\r\n\t\t\t// Reset.\r\n\t\t\treturn this.onTouchCancel()\r\n\t\t}\r\n\r\n\t\tthis.initialTouchX = event.changedTouches[0].clientX\r\n\t\tthis.initialTouchY = event.changedTouches[0].clientY\r\n\t\tthis.tapping = true\r\n\t}\r\n\r\n\tonTouchMove = (event) =>\r\n\t{\r\n\t\tconst { moveThreshold } = this.props\r\n\r\n\t\t// Ignore multitouch.\r\n\t\tif (!this.tapping) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst deltaX = Math.abs(event.changedTouches[0].clientX - this.initialTouchX)\r\n\t\tconst deltaY = Math.abs(event.changedTouches[0].clientY - this.initialTouchY)\r\n\r\n\t\tif (deltaX > moveThreshold || deltaY > moveThreshold)\r\n\t\t{\r\n\t\t\t// Reset.\r\n\t\t\tthis.onTouchCancel()\r\n\t\t}\r\n\t}\r\n\r\n\tonTouchEnd = (event) =>\r\n\t{\r\n\t\t// Ignore multitouch.\r\n\t\tif (!this.tapping) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Reset.\r\n\t\tthis.onTouchCancel()\r\n\r\n\t\tthis.onTap(event)\r\n\t}\r\n\r\n\tonTouchCancel = () =>\r\n\t{\r\n\t\tthis.initialTouchX = undefined\r\n\t\tthis.initialTouchY = undefined\r\n\t\tthis.tapping = false\r\n\t}\r\n\r\n\t// On mobile devices \"blur\" event isn't triggered\r\n\t// when a user taps outside. This is to allow touch scrolling\r\n\t// while not losing focus on an input field or a button.\r\n\t// Adding a manual \"on click\" listener to emulate\r\n\t// \"on blur\" event when user taps outside (to collapse the expandable).\r\n\tonTap = (event) =>\r\n\t{\r\n\t\tconst { getContainerNode, getTogglerNode, onTapOutside } = this.props\r\n\r\n\t\tif (getContainerNode().contains(event.target)) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (getTogglerNode) {\r\n\t\t\tif (getTogglerNode().contains(event.target)) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (onTapOutside) {\r\n\t\t\tthis.focusOut = true\r\n\t\t\tonTapOutside(event)\r\n\t\t\tthis.focusOut = undefined\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { children } = this.props\r\n\t\treturn children\r\n\t}\r\n}"]}