{"version":3,"sources":["../source/TextInputInput.js"],"names":["PureComponent","Component","TextInput","initAutoresizeAttempts","currentHeight","hiddenTextArea","initAutoresize","_isMounted","getMeasurements","haveStylesLoaded","autoresize","setTimeout","event","current","height","scrollHeight","undefined","bordersHeight","Math","abs","input","style","onWindowResize","onChange","value","target","props","onKeyDown","defaultPrevented","storeInputNode","node","inputRef","focus","multiline","window","addEventListener","removeEventListener","verticalPadding","getComputedStyle","ceil","parseFloat","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","id","inputComponent","disabled","label","placeholder","type","indicateInvalid","error","className","containerRef","floatingLabel","required","children","rest","inputStyle","resize","properties","ref","isEmptyValue","autoFocus","rows","HIDDEN_TEXTAREA_STYLE","createElement","propTypes","string","bool","isRequired","oneOfType","func","defaultProps","overflow","visibility","position","whiteSpace"],"mappings":"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","file":"TextInputInput.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\nimport throttle from 'lodash/throttle'\r\nimport createRef from 'react-create-ref'\r\n\r\nimport { getModularGridUnit } from './utility/grid'\r\nimport { submitFormOnCtrlEnter } from './utility/dom'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nexport default class TextInput extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// (optional) HTML `id` attribute.\r\n\t\tid : PropTypes.string,\r\n\r\n\t\t// `<input type/>` attribute.\r\n\t\ttype : PropTypes.string,\r\n\r\n\t\t// Whether `<textarea/>` should autoresize itself\r\n\t\t// (is `true` by default)\r\n\t\tautoresize : PropTypes.bool.isRequired,\r\n\r\n\t\t// In order for this to work properly\r\n\t\t// `<textarea/>` vertical padding should be `0`\r\n\t\t// and instead the padding should be defined on `<textarea/>` parent `<div/>`\r\n\t\t// like it's done in Material UI.\r\n\t\t// Otherwise it won't look pretty and the line of text near the top border\r\n\t\t// will be partially visible resulting in weird UX.\r\n\t\t// If `<textarea/>` vertical padding was `0`\r\n\t\t// the line of text near the top border wouldn't be visible.\r\n\t\t// // The maximum number of rows <textarea/> grows up to.\r\n\t\t// rowsMax          : PropTypes.number.isRequired,\r\n\r\n\t\t// Set to `false` to prevent the `<label/>` from floating\r\n\t\tfloatingLabel    : PropTypes.bool.isRequired,\r\n\r\n\t\t// A custom input component.\r\n\t\t// (is `<input/>` by default)\r\n\t\tinputComponent   : PropTypes.oneOfType\r\n\t\t([\r\n\t\t\tPropTypes.func,\r\n\t\t\tPropTypes.string\r\n\t\t])\r\n\t\t.isRequired\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\t// `<textarea/>` should autoresize itself\r\n\t\tautoresize : true,\r\n\r\n\t\t// Set to `false` to prevent the `<label/>` from floating\r\n\t\tfloatingLabel : true,\r\n\r\n\t\t// A custom input component.\r\n\t\t// (is `<input/>` by default)\r\n\t\tinputComponent : 'input',\r\n\r\n\t\t// // The maximum number of rows <textarea/> grows up to.\r\n\t\t// rowsMax : 12\r\n\t}\r\n\r\n\tinitAutoresizeAttempts = 0\r\n\tcurrentHeight = 0\r\n\r\n\thiddenTextArea = createRef()\r\n\t// hiddenTextAreaSingleLine = createRef()\r\n\r\n\t// Client side rendering, javascript is enabled\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tconst { multiline, autoresize, value } = this.props\r\n\r\n\t\tthis._isMounted = true\r\n\r\n\t\t// Doing `this.measure()` here now\r\n\t\t// because `<textarea/>` should autoresize\r\n\t\t// in case its `value` is set up front.\r\n\t\t// // Not doing `this.measure()` here because\r\n\t\t// // that resulted in weird `<textarea/>` height mismatch.\r\n\t\t// // Measuring the height of `<textarea/>` during\r\n\t\t// // the first `this.measurements()` call instead.\r\n\r\n\t\tif (multiline && autoresize) {\r\n\t\t\tthis.initAutoresize()\r\n\t\t}\r\n\r\n\t\tif (multiline && autoresize) {\r\n\t\t\twindow.addEventListener('resize', this.onWindowResize)\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount()\r\n\t{\r\n\t\tconst { multiline, autoresize } = this.props\r\n\r\n\t\tthis._isMounted = false\r\n\r\n\t\tif (multiline && autoresize) {\r\n\t\t\twindow.removeEventListener('resize', this.onWindowResize)\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidUpdate()\r\n\t{\r\n\t\tconst { autoresize } = this.props\r\n\r\n\t\tif (autoresize) {\r\n\t\t\tthis.autoresize()\r\n\t\t}\r\n\t}\r\n\r\n\t// Even if padding on <textarea/> has been set\r\n\t// it's still possible that `font-size` hasn't been set yet.\r\n\t// (it happened in a project)\r\n\t// So this function doesn't guarantee anything.\r\n\thaveStylesLoaded() {\r\n\t\t// The default <textarea/> top/bottom padding in Chrome on Windows is 2px.\r\n\t\treturn this.verticalPadding > 2 * 2\r\n\t}\r\n\r\n\t// `height` works incorrectly in some weird cases.\r\n\t// For example, when `<textarea/>` is hidden when mounted\r\n\t// or when there's no stylesheet loaded yet.\r\n\t// For example, when stylesheets are included \"dynamically\"\r\n\t// like Webpack's `style-loader` does (is used in development mode,\r\n\t// or when using \"code splitting\" when \"chunks\" are `import()`ed dynamically).\r\n\t//\r\n\t// https://stackoverflow.com/questions/39400038/how-to-ensure-that-hot-css-loads-before-js-in-webpack-dev-server\r\n\t// https://github.com/webpack-contrib/style-loader/issues/269\r\n\t//\r\n\t// An alternative solution would be:\r\n\t//\r\n\t// this.input.minHeight = 0\r\n\t// this.input.minHeight = this.input.scrollHeight + this.bordersHeight\r\n\t//\r\n\t// or:\r\n\t//\r\n\t// this.input.minHeight = this.hiddenTextArea.current.scrollHeight + this.bordersHeight\r\n\t//\r\n\t// which wouldn't ever undersize the <textarea/>\r\n\t// but it would oversize it due to the incorrect\r\n\t// <textarea/> width before styles are loaded.\r\n\t//\r\n\tinitAutoresize = () => {\r\n\t\tif (!this._isMounted) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.initAutoresizeAttempts++\r\n\t\tthis.getMeasurements()\r\n\t\tif (this.haveStylesLoaded()) {\r\n\t\t\tthis.autoresize()\r\n\t\t}\r\n\t\t// Even if padding on <textarea/> has been set\r\n\t\t// it's still possible that `font-size` hasn't been set yet.\r\n\t\t// Or it could be another padding in a subsequent stylesheet.\r\n\t\t// So keep re-initializing <textarea/>, say, for a second.\r\n\t\tif (this.initAutoresizeAttempts <= 5) {\r\n\t\t\tsetTimeout(this.initAutoresize, 200)\r\n\t\t}\r\n\t}\r\n\r\n\tgetMeasurements() {\r\n\t\tconst style = getComputedStyle(this.input)\r\n\r\n\t\t// // Measurements can be in `em`s/`rem`s/`pt`s which can give fractional pixel sizes.\r\n\t\t// // `style.height` includes borders.\r\n\t\t// this.currentHeight = Math.ceil(parseFloat(style.height))\r\n\t\t// this.minHeight = this.currentHeight\r\n\r\n\t\t// Get vertical padding.\r\n\t\t// Measurements can be in `em`s/`rem`s/`pt`s which can give fractional pixel sizes.\r\n\t\tthis.verticalPadding = Math.ceil(parseFloat(style.paddingTop)) + Math.ceil(parseFloat(style.paddingBottom))\r\n\r\n\t\t// Top and bottom borders are extra height,\r\n\t\t// because `.scrollHeight` doesn't include borders.\r\n\t\t// Measurements can be in `em`s/`rem`s/`pt`s which can give fractional pixel sizes.\r\n\t\tthis.bordersHeight =\r\n\t\t\tMath.ceil(parseFloat(style.borderTopWidth)) +\r\n\t\t\tMath.ceil(parseFloat(style.borderBottomWidth))\r\n\t}\r\n\r\n\t// Copy-pasted from Material UI on Oct 24th, 2018.\r\n\t// https://github.com/mui-org/material-ui/blob/master/packages/material-ui/src/InputBase/Textarea.js\r\n\t//\r\n\tautoresize = (event) =>\r\n\t{\r\n\t\t// const { rowsMax } = this.props\r\n\r\n\t\t// Guarding for **broken** shallow rendering method that call componentDidMount\r\n\t\t// but doesn't handle refs correctly.\r\n\t\t// To remove once the shallow rendering has been fixed.\r\n\t\tif (!this.hiddenTextArea.current) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// const lineHeight = this.hiddenTextAreaSingleLine.current.scrollHeight - this.verticalPadding\r\n\t\tlet height = this.hiddenTextArea.current.scrollHeight\r\n\r\n\t\t// Guarding for jsdom, where scrollHeight isn't present.\r\n\t\t// See https://github.com/tmpvar/jsdom/issues/1013\r\n\t\tif (height === undefined) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// It would have to first subtract `paddingTop` and `paddingBottom`,\r\n\t\t// then it would calculate `rowsMax * lineHeight` and\r\n\t\t// then it would re-add `paddingTop` and `paddingBottom`.\r\n\t\t// height = Math.min(rowsMax * lineHeight + this.verticalPadding, height)\r\n\r\n\t\t// `.scrollHeight` doesn't include borders.\r\n\t\t// `.style.height` does include borders.\r\n\t\theight += this.bordersHeight\r\n\r\n\t\t// if (height <= this.minHeight) {\r\n\t\t// \theight = this.minHeight\r\n\t\t// }\r\n\t\t// For some weird reason Chrome on Windows 10\r\n\t\t// requires an extra pixel been added\r\n\t\t// to avoid showing vertical scrollbar.\r\n\t\t// (Oct 24th, 2018)\r\n\t\t// else {\r\n\t\t\theight += 1\r\n\t\t// }\r\n\r\n\t\t// \"Need a large enough different to update the height.\r\n\t\t//  This prevents infinite rendering loop.\"\r\n\t\t// It's unclear what loop they're talking about.\r\n\t\tif (Math.abs(this.currentHeight - height) > 1) {\r\n\t\t\tthis.currentHeight = height\r\n\t\t\t// `.style.height` includes borders.\r\n\t\t\tthis.input.style.height = height + 'px'\r\n\t\t}\r\n\t}\r\n\r\n\tonWindowResize = throttle((event) => this.autoresize(), 100)\r\n\r\n\t// The underlying `input` component\r\n\t// can pass both `event`s and `value`s\r\n\t// to this parent `onChange` listener.\r\n\tonChange = (event) =>\r\n\t{\r\n\t\t// Extract `value` from the argument\r\n\t\t// of this `onChange` listener\r\n\t\t// (for convenience)\r\n\r\n\t\tlet value = event\r\n\r\n\t\tif (event.target !== undefined) {\r\n\t\t\tvalue = event.target.value\r\n\t\t}\r\n\r\n\t\t// Call the parent `onChange` handler\r\n\t\t// with the `value` as an argument\r\n\t\t// (for convenience)\r\n\r\n\t\tconst { onChange } = this.props\r\n\r\n\t\t// Call `onChange` only if `value` did actually change\r\n\t\tif (value !== this.props.value) {\r\n\t\t\tonChange(value)\r\n\t\t}\r\n\t}\r\n\r\n\tonKeyDown = (event) =>\r\n\t{\r\n\t\tconst { onKeyDown } = this.props\r\n\r\n\t\tif (onKeyDown) {\r\n\t\t\tonKeyDown(event)\r\n\t\t}\r\n\r\n\t\tif (event.defaultPrevented) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (submitFormOnCtrlEnter(event, this.input)) {\r\n\t\t\treturn\r\n\t\t}\r\n\t}\r\n\r\n\tstoreInputNode = (node) =>\r\n\t{\r\n\t\tconst { inputRef } = this.props\r\n\r\n\t\tif (inputRef) {\r\n\t\t\tinputRef(node)\r\n\t\t}\r\n\r\n\t\tthis.input = node\r\n\t}\r\n\r\n\tfocus = () => this.input.focus()\r\n\r\n\trender()\r\n\t{\r\n\t\tconst\r\n\t\t{\r\n\t\t\tid,\r\n\t\t\tvalue,\r\n\t\t\tmultiline,\r\n\t\t\tinputComponent,\r\n\t\t\tfocus,\r\n\t\t\tonChange,\r\n\t\t\tdisabled,\r\n\t\t\tlabel,\r\n\t\t\tplaceholder,\r\n\t\t\ttype,\r\n\t\t\tautoresize,\r\n\t\t\tindicateInvalid,\r\n\t\t\terror,\r\n\t\t\tclassName,\r\n\r\n\t\t\t// Rest\r\n\t\t\tinputRef,\r\n\t\t\tcontainerRef,\r\n\t\t\tfloatingLabel,\r\n\t\t\trequired,\r\n\t\t\tchildren,\r\n\t\t\t...rest\r\n\t\t}\r\n\t\t= this.props\r\n\r\n\t\tlet { inputStyle } = this.props\r\n\r\n\t\tif (multiline && autoresize)\r\n\t\t{\r\n\t\t\tinputStyle =\r\n\t\t\t{\r\n\t\t\t\tresize : 'none',\r\n\t\t\t\t...inputStyle\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst properties =\r\n\t\t{\r\n\t\t\t...rest,\r\n\t\t\tid,\r\n\t\t\tref : this.storeInputNode,\r\n\t\t\tvalue : isEmptyValue(value) ? '' : value,\r\n\t\t\tdisabled,\r\n\t\t\t'aria-label'    : rest['aria-label'] || (id && label ? undefined : label),\r\n\t\t\t'aria-required' : rest['aria-required'] || (required ? true : undefined),\r\n\t\t\t'aria-invalid'  : rest['aria-invalid'] || (error && indicateInvalid ? true : undefined),\r\n\t\t\tplaceholder,\r\n\t\t\tonChange    : this.onChange,\r\n\t\t\tonKeyDown   : this.onKeyDown,\r\n\t\t\tclassName   : classNames\r\n\t\t\t(\r\n\t\t\t\t// `<TextInput/>` has `border-color` to indicate its `:focus` state.\r\n\t\t\t\t// Therefore the `outline` can be safely removed.\r\n\t\t\t\t'rrui__outline',\r\n\t\t\t\t'rrui__input-element',\r\n\t\t\t\t'rrui__input-field',\r\n\t\t\t\t{\r\n\t\t\t\t\t// CSS selector performance optimization\r\n\t\t\t\t\t'rrui__input-field--invalid'   : indicateInvalid && error,\r\n\t\t\t\t\t'rrui__input-field--disabled'  : disabled,\r\n\t\t\t\t\t'rrui__input-field--multiline' : multiline\r\n\t\t\t\t},\r\n\t\t\t\tclassName\r\n\t\t\t),\r\n\t\t\tstyle       : inputStyle,\r\n\t\t\tautoFocus   : focus\r\n\t\t}\r\n\r\n\t\t// In case of `multiline` set to `true`\r\n\t\t// this is gonna be a `<textarea/>`\r\n\t\tif (multiline)\r\n\t\t{\r\n\t\t\tif (autoresize) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t// <textarea\r\n\t\t\t\t\t// \tkey=\"textarea-measurement-single-line\"\r\n\t\t\t\t\t// \tref={this.hiddenTextAreaSingleLine}\r\n\t\t\t\t\t// \trows=\"1\"\r\n\t\t\t\t\t// \treadOnly\r\n\t\t\t\t\t// \taria-hidden=\"true\"\r\n\t\t\t\t\t// \tvalue=\"\"\r\n\t\t\t\t\t// \ttabIndex={-1}\r\n\t\t\t\t\t// \tclassName={properties.className}\r\n\t\t\t\t\t// \tstyle={this.props.inputStyle ? { ...inputStyle, ...HIDDEN_TEXTAREA_STYLE } : HIDDEN_TEXTAREA_STYLE}/>,\r\n\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tkey=\"textarea-measurement\"\r\n\t\t\t\t\t\tref={this.hiddenTextArea}\r\n\t\t\t\t\t\treadOnly\r\n\t\t\t\t\t\taria-hidden\r\n\t\t\t\t\t\tvalue={properties.value}\r\n\t\t\t\t\t\trows={properties.rows}\r\n\t\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\t\tclassName={properties.className}\r\n\t\t\t\t\t\tstyle={this.props.inputStyle ? { ...inputStyle, ...HIDDEN_TEXTAREA_STYLE } : HIDDEN_TEXTAREA_STYLE}/>,\r\n\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tkey=\"textarea\"\r\n\t\t\t\t\t\t{ ...properties }/>\r\n\t\t\t\t]\r\n\t\t\t}\r\n\r\n\t\t\treturn <textarea key=\"textarea\" { ...properties }/>\r\n\t\t}\r\n\r\n\t\t// Add `<input/>` `type` property.\r\n\t\tif (inputComponent === 'input') {\r\n\t\t\tproperties.type = type || 'text'\r\n\t\t}\r\n\r\n\t\treturn React.createElement(inputComponent, properties)\r\n\t}\r\n}\r\n\r\n// https://github.com/mui-org/material-ui/blob/master/packages/material-ui/src/InputBase/Textarea.js\r\nconst HIDDEN_TEXTAREA_STYLE = {\r\n\t// Overflow also needed to here to remove the extra row\r\n\t// added to `<textarea/>`s in Firefox.\r\n\toverflow: 'hidden',\r\n\t// Visibility needed to hide the extra `<textarea/>` on iPads.\r\n\tvisibility: 'hidden',\r\n\tposition: 'absolute',\r\n\theight: 'auto',\r\n\t// Don't know why is it here.\r\n\twhiteSpace: 'pre-wrap'\r\n}\r\n\r\nfunction isEmptyValue(value) {\r\n\treturn value === '' || value === undefined || value === null\r\n}"]}