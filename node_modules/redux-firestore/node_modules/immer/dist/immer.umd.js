var e,r;e=this,r=function(e){"use strict";function r(e,r,n,t,o,i){var a,f,u,c,p;n&&(Array.isArray(o)?function(e,r,n,t,o,i){for(var a=Math.min(o.length,i.length),f=0;f<a;f++)if(e.assigned[f]&&o[f]!==i[f]){var u=r.concat(f);n.push({op:"replace",path:u,value:i[f]}),t.push({op:"replace",path:u,value:o[f]})}if(a<i.length){for(var c=a;c<i.length;c++){var p=r.concat(c);n.push({op:"add",path:p,value:i[c]})}t.push({op:"replace",path:r.concat("length"),value:o.length})}else if(a<o.length){n.push({op:"replace",path:r.concat("length"),value:i.length});for(var s=a;s<o.length;s++){var d=r.concat(s);t.push({op:"add",path:d,value:o[s]})}}}(e,r,n,t,o,i):(a=r,f=n,u=t,c=o,p=i,d(e.assigned,function(e,r){var n=c[e],t=p[e],o=r?e in c?"replace":"add":"remove";if(n!==c||"replace"!==o){var i=a.concat(e);f.push("remove"===o?{op:o,path:i}:{op:o,path:i,value:t}),u.push("add"===o?{op:"remove",path:i}:"remove"===o?{op:"add",path:i,value:n}:{op:"replace",path:i,value:n})}})))}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t="undefined"!=typeof Symbol?Symbol("immer-proxy-state"):"__$immer_state",o="An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.";var i=!("undefined"!=typeof process&&"production"===process.env.NODE_ENV||"verifyMinified"!==function(){}.name),a="undefined"!=typeof Proxy;function f(e){return!!e&&!!e[t]}function u(e){if(!e)return!1;if("object"!==(void 0===e?"undefined":n(e)))return!1;if(Array.isArray(e))return!0;var r=Object.getPrototypeOf(e);return null===r||r===Object.prototype}function c(e){return i&&Object.freeze(e),e}var p=Object.assign||function(e,r){for(var n in r)l(r,n)&&(e[n]=r[n]);return e};function s(e){if(Array.isArray(e))return e.slice();var r=void 0===e.__proto__?Object.create(null):{};return p(r,e)}function d(e,r){if(Array.isArray(e))for(var n=0;n<e.length;n++)r(n,e[n]);else for(var t in e)r(t,e[t])}function l(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function h(e,n,o,i){if(f(e)){var p=e[t];if(!0===p.modified){if(!0===p.finalized)return p.copy;p.finalized=!0;var v=(y=a?p.copy:p.copy=s(e),b=n,m=o,w=i,O=(g=p).base,d(y,function(e,r){if(r!==O[e]){var n=m&&!l(g.assigned,e);y[e]=h(r,n&&b.concat(e),n&&m,w)}}),c(y));return r(p,n,o,i,p.base,v),v}return p.base}var y,g,b,m,w,O;return function e(r){if(!u(r))return;if(Object.isFrozen(r))return;d(r,function(n,t){f(t)?r[n]=h(t):e(t)});c(r)}(e),e}function v(e,r){return e===r?0!==e||1/e==1/r:e!=e&&r!=r}var y=null,g={get:function(e,r){if(r===t)return e;if(e.modified){var n=e.copy[r];return n===e.base[r]&&u(n)?e.copy[r]=O(e,n):n}if(l(e.proxies,r))return e.proxies[r];var o=e.base[r];return!f(o)&&u(o)?e.proxies[r]=O(e,o):o},has:function(e,r){return r in m(e)},ownKeys:function(e){return Reflect.ownKeys(m(e))},set:function(e,r,n){if(e.assigned[r]=!0,!e.modified){if(r in e.base&&v(e.base[r],n)||l(e.proxies,r)&&e.proxies[r]===n)return!0;w(e)}return e.copy[r]=n,!0},deleteProperty:function(e,r){return e.assigned[r]=!1,w(e),delete e.copy[r],!0},getOwnPropertyDescriptor:function(e,r){var n=e.modified?e.copy:l(e.proxies,r)?e.proxies:e.base,t=Reflect.getOwnPropertyDescriptor(n,r);!t||Array.isArray(n)&&"length"===r||(t.configurable=!0);return t},defineProperty:function(){throw new Error("Immer does not support defining properties on draft objects.")},setPrototypeOf:function(){throw new Error("Immer does not support `setPrototypeOf()`.")}},b={};function m(e){return!0===e.modified?e.copy:e.base}function w(e){e.modified||(e.modified=!0,e.copy=s(e.base),Object.assign(e.copy,e.proxies),e.parent&&w(e.parent))}function O(e,r,n){if(f(r))throw new Error("Immer bug. Plz report.");var t={modified:!1,assigned:{},finalized:!1,parent:e,base:r,copy:void 0,proxies:{}},o=Array.isArray(r)?Proxy.revocable([t],b):Proxy.revocable(t,g);return y.push(o),o.proxy}d(g,function(e,r){b[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});var j={},x=null;function A(e){return e.hasCopy?e.copy:e.base}function P(e){e.modified||(e.modified=!0,e.parent&&P(e.parent))}function E(e){e.hasCopy||(e.hasCopy=!0,e.copy=s(e.base))}function k(e,r){var n=s(r);d(r,function(e){var r;Object.defineProperty(n,""+e,j[r=""+e]||(j[r]={configurable:!0,enumerable:!0,get:function(){return function(e,r){z(e);var n=A(e)[r];return!e.finalizing&&n===e.base[r]&&u(n)?(E(e),e.copy[r]=k(e,n)):n}(this[t],r)},set:function(e){!function(e,r,n){if(z(e),e.assigned[r]=!0,!e.modified){if(v(A(e)[r],n))return;P(e),E(e)}e.copy[r]=n}(this[t],r,e)}}))});var o,i,a,f={modified:!1,assigned:{},hasCopy:!1,parent:e,base:r,proxy:n,copy:void 0,finished:!1,finalizing:!1,finalized:!1};return o=n,i=t,a=f,Object.defineProperty(o,i,{value:a,enumerable:!1,writable:!0}),x.push(f),n}function z(e){if(!0===e.finished)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(e.copy||e.base))}function _(e){if(e&&"object"===(void 0===e?"undefined":n(e))){var r=e[t];if(r){var o,i,a,f,u=r.proxy,c=r.base;if(Array.isArray(e)){if(S(r)){if(P(r),r.assigned.length=!0,u.length<c.length)for(var p=u.length;p<c.length;p++)r.assigned[p]=!1;else for(var s=c.length;s<u.length;s++)r.assigned[s]=!0;d(u,function(e,n){r.assigned[e]||_(n)})}}else{var l=(o=c,i=u,a=Object.keys(o),{added:(f=Object.keys(i)).filter(function(e){return-1===a.indexOf(e)}),removed:a.filter(function(e){return-1===f.indexOf(e)})}),h=l.added,v=l.removed;(h.length>0||v.length>0)&&P(r),d(h,function(e,n){r.assigned[n]=!0}),d(v,function(e,n){r.assigned[n]=!1}),d(u,function(e,n){r.assigned[e]||_(n)})}}}}function S(e){var r=e.proxy;if(r.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(r,r.length-1);return!(!n||n.get)}function C(e,r,i){if(f(e)){var a=r.call(e,e);return void 0===a?e:a}var u=x;x=[];var c=i&&[],p=i&&[];try{var s=k(void 0,e),l=r.call(s,s);d(x,function(e,r){r.finalizing=!0});var y=void 0;if(void 0!==l&&l!==s){if(s[t].modified)throw new Error(o);y=h(l),c&&(c.push({op:"replace",path:[],value:y}),p.push({op:"replace",path:[],value:e}))}else i&&_(s),function(){for(var e=x.length-1;e>=0;e--){var r=x[e];!1===r.modified&&(Array.isArray(r.base)?S(r)&&P(r):(t=r,o=Object.keys(t.base),i=Object.keys(t.proxy),function(e,r){if(v(e,r))return!0;if("object"!==(void 0===e?"undefined":n(e))||null===e||"object"!==(void 0===r?"undefined":n(r))||null===r)return!1;var t=Object.keys(e),o=Object.keys(r);if(t.length!==o.length)return!1;for(var i=0;i<t.length;i++)if(!hasOwnProperty.call(r,t[i])||!v(e[t[i]],r[t[i]]))return!1;return!0}(o,i)||P(r)))}var t,o,i}(),y=h(s,[],c,p);return d(x,function(e,r){r.finished=!0}),i&&i(c,p),y}finally{x=u}}function D(e,r,i){if(arguments.length<1||arguments.length>3)throw new Error("produce expects 1 to 3 arguments, got "+arguments.length);if("function"==typeof e){if("function"==typeof r)throw new Error("if first argument is a function (curried invocation), the second argument to produce cannot be a function");var c=r,p=e;return function(){var e=arguments;return D(void 0===e[0]&&void 0!==c?c:e[0],function(r){return e[0]=r,p.apply(r,e)})}}if("function"!=typeof r)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==i&&"function"!=typeof i)throw new Error("the third argument of a producer should not be set or a function");if("object"!==(void 0===e?"undefined":n(e))||null===e){var s=r(e);return void 0===s?e:s}if(!u(e))throw new Error("the first argument to an immer producer should be a primitive, plain object or array, got "+(void 0===e?"undefined":n(e))+': "'+e+'"');return a?function(e,r,n){if(f(e)){var i=r.call(e,e);return void 0===i?e:i}var a=y;y=[];var u=n&&[],c=n&&[];try{var p=O(void 0,e),s=r.call(p,p),l=void 0;if(void 0!==s&&s!==p){if(p[t].modified)throw new Error(o);l=h(s),u&&(u.push({op:"replace",path:[],value:l}),c.push({op:"replace",path:[],value:e}))}else l=h(p,[],u,c);return d(y,function(e,r){return r.revoke()}),n&&n(u,c),l}finally{y=a}}(e,r,i):C(e,r,i)}var I=D(function(e,r){for(var n=function(n){var t=r[n];if(0===t.path.length&&"replace"===t.op)e=t.value;else{var o=t.path.slice(),i=o.pop(),a=o.reduce(function(e,r){if(!e)throw new Error("Cannot apply patch, path doesn't resolve: "+t.path.join("/"));return e[r]},e);if(!a)throw new Error("Cannot apply patch, path doesn't resolve: "+t.path.join("/"));switch(t.op){case"replace":case"add":a[i]=t.value;break;case"remove":if(Array.isArray(a)){if(i!==a.length-1)throw new Error("Remove can only remove the last key of an array, index: "+i+", length: "+a.length);a.length-=1}else delete a[i];break;default:throw new Error("Unsupported patch operation: "+t.op)}}},t=0;t<r.length;t++)n(t);return e});e.produce=D,e.default=D,e.applyPatches=I,e.setAutoFreeze=function(e){i=e},e.setUseProxies=function(e){a=e},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.immer={});
//# sourceMappingURL=immer.umd.js.map
